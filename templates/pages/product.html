---
product:
    videos:
        limit: {{theme_settings.productpage_videos_count}}
    reviews:
        limit: {{theme_settings.productpage_reviews_count}}
    related_products:
        limit: {{theme_settings.productpage_related_products_count}}
    similar_by_views:
        limit: {{theme_settings.productpage_similar_by_views_count}}
---
{{#partial "page"}}
    {{> components/common/breadcrumbs breadcrumbs=breadcrumbs}}

    {{#each product.shipping_messages}}
        {{> components/common/alert-info message}}
    {{/each}}

    <div itemscope itemtype="http://schema.org/Product">
        {{> components/products/product-view schema=true  }}

        {{{region name="product_below_content"}}}

        {{#if product.videos.list.length}}
            {{> components/products/videos product.videos}}
        {{/if}}

        {{#all settings.show_product_reviews (if theme_settings.show_product_reviews_tabs '!==' true)}}
            {{> components/products/reviews reviews=product.reviews product=product urls=urls}}
        {{/all}}

        <div id="isp-related-tabs">
            <div id="isp-related-tab-1">You May Also Like...</div>
            <div id="isp-related-tab-2">Recently Viewed</div>
        </div>

        <div id="isp-related-widgets">
            <div title="You May Also Like..." layout="horizontal" sources="related_views,similar_products,related_recently_viewed,related_purchase" id="isp-related-widget-1"></div>
            <div title="Recently Viewed" layout="horizontal" sources="related_recently_viewed,related_top_products" id="isp-related-widget-2"></div>
        </div>

        <script src="https://acp-magento.appspot.com/js/isp_related_products.js?v=1.0.9&UUID=2a7b6022-1080-487d-9179-6512b21800fa&store=1"></script>

        <!-- <script src="https://acp-magento.appspot.com/js/isp_related_products.js?v=1.0.9&UUID=eb981cff-208f-49ef-ac71-32fc911beaf1&store=1"></script> -->

        <script>
            // configure isp related tabs
            (function() {
                var tab1 = document.querySelector("#isp-related-tab-1");
                var tab2 = document.querySelector("#isp-related-tab-2");
                var widget1 = document.querySelector("#isp-related-widget-1");
                var widget2 = document.querySelector("#isp-related-widget-2");

                tab1.addEventListener("click", function() {
                    widget1.style.display = "block";
                });

                tab2.addEventListener("click", function() {
                    widget1.style.display = "none";
                });
            })();
        </script>
    </div>
{{/partial}}
{{> layout/base}}

<script type="text/javascript">
    var _learnq = _learnq || [];

    var item = {
        Name: "{{product.title}}",
        ProductID: "{{product.id}}",
        ImageURL: "{{getImage product.main_image 'product_size' (cdn theme_settings.default_image_product)}}",
        URL: "{{product.url}}",
        Brand: "{{product.brand.name}}",
        Price: "{{product.price.without_tax.value}}",
        CompareAtPrice: "{{product.price.rrp_without_tax.value}}"
    };

    _learnq.push(['track', 'Viewed Product', item]);

    _learnq.push(['trackViewedItem', {
        Title: item.Name,
        ItemId: item.ProductID,
        ImageUrl: item.ImageURL,
        Url: item.URL,

        Metadata: {
        Brand: item.Brand,
        Price: item.Price,
        CompareAtPrice: item.CompareAtPrice
    }
    }]);
</script>
