{{#if banners.bottom}}
    {{#if settings.data_tag_enabled}}
        <div class="banners" data-banner-location="bottom">
            {{#each (limit banners.bottom_metadata 1)}}
                <div class="banner" data-event-type="promotion" data-entity-id="{{this.id}}" data-name="{{this.banner-name}}" data-position="{{this.location}}" data-name="{{this.banner-name}}">
                    <div data-event-type="promotion-click">
                        {{{this.content}}}
                    </div>
                </div>
            {{/each}}
        </div>
    {{else}}
        <div class="banners" data-banner-location="bottom">
            <div class="banner">
                {{{limit banners.bottom 1}}}
            </div>
        </div>
    {{/if}}

{{/if}}
<footer class="footer" role="contentinfo">
    <div class="container">
        {{#if theme_settings.social_icon_placement_bottom '!==' 'bottom_none'}}
            <article class="footer-info-col
                footer-info-col--social
                footer-info-col--{{#if theme_settings.social_icon_placement_bottom '===' 'bottom_left'}}left{{else}}right{{/if}}"
                data-section-type="footer-webPages">
                    <h5 class="footer-info-heading">{{lang 'social.connect'}}</h5>
                    {{> components/common/social-links}}
            </article>
        {{/if}}
        <section class="footer-info">
            <article class="footer-info-col footer-info-col--small" data-section-type="footer-categories">
                <h5 class="footer-info-heading">Contact</h5>
                <ul class="footer-info-list">
                    <li>
                        <a id="footer-hero-action">Stylist Chat</a>
                    </li>
                    <li>
                        <a href="/consult-a-stylist">Consult a Stylist</a>
                    </li>
                    <li>
                        <a href="/contact-us">Contact Us</a>
                    </li>
                    <li>
                        <a href="/store-locator">Retailers</a>
                    </li>
                </ul>
            </article>

            <article class="footer-info-col footer-info-col--small" data-section-type="footer-categories">
                <h5 class="footer-info-heading">Assistance</h5>
                <ul class="footer-info-list">
                    <li>
                        <a href="/assistance/#track-your-order">Track Your Order</a>
                    </li>
                    <li>
                        <a href="/assistance/#shipping">Shipping</a>
                    </li>
                    <li>
                        <a href="/assistance/#exchanges-and-returns">Exchanges &amp; Returns</a>
                    </li>
                    <li>
                        <a href="/assistance/#faqs">FAQs</a>
                    </li>
                    <li>
                        <a href="/assistance/#care-and-repair">Care &amp; Repair</a>
                    </li>
                </ul>
            </article>

            <article class="footer-info-col footer-info-col--small" data-section-type="footer-categories">
                <h5 class="footer-info-heading">Services</h5>
                <ul class="footer-info-list">
                    <li>
                        <a class="size-guide-action" href="#size-guide" data-reveal-id="size-guide">Size Guide</a>
                    </li>
                </ul>
            </article>

            <article class="footer-info-col footer-info-col--small" data-section-type="footer-categories">
                <h5 class="footer-info-heading">Our Company</h5>
                <ul class="footer-info-list">
                    <li>
                        <a href="/world-of-ippolita">About</a>
                    </li>
                    <li>
                        <a href="/legal/#privacy-policy">Privacy Policy</a>
                    </li>
                    <li>
                        <a href="/legal/#terms-of-use">Terms &amp; Conditions</a>
                    </li>
                    <li>
                        <a href="/accessibility-statement">Accessibility Statement</a>
                    </li>
                </ul>
            </article>

            <article class="footer-info-col" data-section-type="newsletterSubscription">
                {{#if settings.show_newsletter_box}}
                    {{> components/common/subscription-form}}
                {{/if}}
                <h5 class="footer-info-heading" style="margin-top: 0">Follow Us</h5>
                <ul class="socialLinks socialLinks--alt">
                    <li class="socialLinks-item">
                        <a class="icon icon--facebook" href="https://www.facebook.com/IppolitaJewelry/" target="_blank">
                            <svg><use xlink:href="#icon-facebook"></use></svg>
                        </a>
                    </li>
                    <li class="socialLinks-item">
                        <a class="icon icon--instagram" href="https://www.instagram.com/ippolita/" target="_blank">
                            <svg><use xlink:href="#icon-instagram"></use></svg>
                        </a>
                    </li>
                </ul>
                {{> components/common/payment-icons}}
            </article>
        </section>
        {{#if theme_settings.geotrust_ssl_common_name}}
            <div class="footer-geotrust-ssl-seal">
                {{> components/common/geotrust-ssl-seal}}
            </div>
        {{/if}}
        {{#if theme_settings.show_copyright_footer}}
            <div class="footer-copyright center">
                <p class="powered-by">&copy; {{moment format="YYYY"}} {{settings.store_name}} - <a href="/sitemap.php">Site Map</a></p>
            </div>
        {{/if}}
    </div>
</footer>

<script type="text/javascript">
    // configureBannerTop();
    configureHeader();
    configureFooter();
    configureMobileNav();
    configureSearchActionMobile();
    configureSearchActionDesktop();
    configureSizeGuideAction();

    // RUNS ONLY ON HOME PAGE
    function configureClearHeader() {
        // var bannerTop = document.querySelector(".banner-top");
        var header = document.querySelector("header");
        var quickSearchAction = document.querySelector(".navUser-action--quickSearch");
        var quickSearchDropdown = document.querySelector(".dropdown--quickSearch");
        var jewelryAction = document.querySelector(".navPages-item:nth-child(2)");
        var newArrivalsAction = document.querySelector(".navPages-item:nth-child(4)");
        var giftsAction = document.querySelector(".navPages-item:nth-child(6)");
        var woiAction = document.querySelector(".navPages-item:last-child");
        var targetNavItems = [jewelryAction, newArrivalsAction, giftsAction, woiAction];
        var activeNavItem = null;

        // initialize header state
        if (window.scrollY == 0) {
            // bannerTop.classList.add("banner-top-clear");
            header.classList.add("header-clear");
        }

        // update header state on scroll
        window.onscroll = function() {
            if (window.scrollY == 0) {
                // bannerTop.classList.add("banner-top-clear");
                header.classList.add("header-clear");

                if (activeNavItem == null) {
                    // bannerTop.classList.add("banner-top-clear");
                    header.classList.add("header-clear");
                } else {
                    // bannerTop.classList.remove("banner-top-clear");
                    header.classList.remove("header-clear");
                }
            } else {
                // bannerTop.classList.remove("banner-top-clear");
                header.classList.remove("header-clear");
            }
        };

        // update header state on search action click
        quickSearchAction.onclick = function(e) {
            if (activeNavItem == null) {
                activeNavItem = this;

                if (window.scrollY == 0) {
                    // bannerTop.classList.remove("banner-top-clear");
                    header.classList.remove("header-clear");
                }
            } else if (activeNavItem == this) {
                activeNavItem = null;

                if (window.scrollY == 0) {
                    // bannerTop.classList.add("banner-top-clear");
                    header.classList.add("header-clear");
                }
            }
        }

        for (var i = 0; i < targetNavItems.length; i++) {
            targetNavItems[i].addEventListener("mouseenter", function(e) {
                var subMenu = e.target.querySelector(".navPage-subMenu");

                if (quickSearchDropdown.classList.contains("is-open")) {
                    quickSearchAction.click();
                }

                if (subMenu) {
                    // bannerTop.classList.remove("banner-top-clear");
                    header.classList.remove("header-clear");
                    subMenu.classList.add("is-open");
                    activeNavItem = this;
                }
            });

            targetNavItems[i].addEventListener("mouseleave", function(e) {
                var subMenu = e.target.querySelector(".navPage-subMenu");

                if (subMenu) {
                    if (window.scrollY == 0) {
                        // bannerTop.classList.add("banner-top-clear");
                        header.classList.add("header-clear");
                    }

                    subMenu.classList.remove("is-open");
                    activeNavItem = null;
                }
            });
        }
    }

    function configureBannerTop() {
        var target = document.querySelector(".banner-top");
        var index = 0;
        var messages = [
            "$500 off $2,000+ with code GIFT500",
            "$1,500 off $5,000+ with code GIFT1500",
            "$3,000 off $10,000+ with code GIFT3000",
            "$200 off $1,000+ with code GIFT200"
        ];
        window.setInterval(function() {
            target.innerHTML = messages[index];

            index = index == 3 ? 0 : index + 1;
        }, 5000);
    }

    function configureHeader() {
        var jewelryAction = document.querySelector(".navPages-item:nth-child(2)");
        var newArrivalsAction = document.querySelector(".navPages-item:nth-child(4)");
        var giftsAction = document.querySelector(".navPages-item:nth-child(6)");
        var woiAction = document.querySelector(".navPages-item:last-child");
        var targetNavItems = [jewelryAction, newArrivalsAction, giftsAction, woiAction];

        // configure main dropdowns
        for (var i = 0; i < targetNavItems.length; i++) {
            targetNavItems[i].addEventListener("mouseenter", function(e) {
                var quickSearchAction = document.querySelector(".navUser-action--quickSearch");
                var quickSearchDropdown = document.querySelector(".dropdown--quickSearch");
                var subMenu = e.target.querySelector(".navPage-subMenu");

                if (quickSearchDropdown.classList.contains("is-open")) {
                    quickSearchAction.click();
                }

                if (subMenu) {
                    subMenu.classList.add("is-open");
                }
            });

            targetNavItems[i].addEventListener("mouseleave", function(e) {
                var subMenu = e.target.querySelector(".navPage-subMenu");

                if (subMenu) {
                    subMenu.classList.remove("is-open");
                }
            });
        }

        // configure dropdown tabs
        for (var navItem of targetNavItems) {
            var tabLabels = navItem.querySelectorAll(".navPage-subMenu-item");

            if (tabLabels.length > 1) {
                for (var tabLabel of tabLabels) {
                    tabLabel.addEventListener("mouseenter", function(e) {
                        var localLabels = e.target.parentNode.querySelectorAll(".navPage-subMenu-item");
                        var localTabs = e.target.parentNode.nextSibling.nextSibling.querySelectorAll(".navPage-subMenu-content-tab");

                        for (var i = 0; i < localLabels.length; i++) {
                            localLabels[i].classList.remove("selected");
                            localTabs[i].style.display = "none";
                        }

                        var currentIndex = e.target.getAttribute("data-index");

                        localLabels[currentIndex].classList.add("selected");
                        localTabs[currentIndex].style.display = "flex";

                        // choose tab link
                        var localLinks = e.target.parentNode.parentNode.querySelectorAll(".navPage-subMenu-entry-links > a");

                        if (localLinks.length) {
                            for (var i = 0; i < localLinks.length; i++) {
                                localLinks[i].style.display = "none";
                            }

                            localLinks[currentIndex].style.display = "block";
                        }
                    });
                }
            }
        }

        // configure right carousel action
        var rightChevrons = document.querySelectorAll(".navPage-subMenu-content-tab > .icon-chevron-right");

        for (var rightChevron of rightChevrons) {
            rightChevron.addEventListener("click", function(e) {
                var itemsToHide = e.currentTarget.parentNode.querySelectorAll(".navPage-subMenu-content-tab-1");
                var itemsToShow = e.currentTarget.parentNode.querySelectorAll(".navPage-subMenu-content-tab-2");

                for (var i = 0; i < itemsToHide.length; i++) {
                    itemsToHide[i].style.display = "none";
                    itemsToShow[i].style.display = "block";
                }

                e.currentTarget.style.display = "none";
                e.currentTarget.parentNode.querySelector(".icon-chevron-left").style.display = "inline-block";
            });
        }

        // configure left carousel action
        var leftChevrons = document.querySelectorAll(".navPage-subMenu-content-tab > .icon-chevron-left");

        for (var leftChevron of leftChevrons) {
            leftChevron.addEventListener("click", function(e) {
                var itemsToHide = e.currentTarget.parentNode.querySelectorAll(".navPage-subMenu-content-tab-2");
                var itemsToShow = e.currentTarget.parentNode.querySelectorAll(".navPage-subMenu-content-tab-1");

                for (var i = 0; i < itemsToHide.length; i++) {
                    itemsToHide[i].style.display = "none";
                    itemsToShow[i].style.display = "block";
                }

                e.currentTarget.style.display = "none";
                e.currentTarget.parentNode.querySelector(".icon-chevron-right").style.display = "inline-block";
            });
        }
    }

    function configureFooter() {
        document.querySelector("#footer-hero-action").addEventListener("click", function(event){
            event.preventDefault();

            hero("show");
        });
    }

    function configureMobileNav() {
        var mobileNavPagesItems = document.querySelectorAll(".navPages-item-mobile");

        for (var mobileNavPagesItem of mobileNavPagesItems) {
            mobileNavPagesItem.addEventListener("click", function(e) {
                e.currentTarget.querySelector(".navPage-subMenu").style.display = "block";
            });
        }

        var mobileSubMenuHeaders = document.querySelectorAll(".navPage-subMenu-header");

        for (var mobileSubMenuHeader of mobileSubMenuHeaders) {
            mobileSubMenuHeader.addEventListener("click", function(e) {
                e.stopPropagation();

                e.currentTarget.parentNode.parentNode.style.display = "none";
            });
        }

        var mobileSubMenuTriggers = document.querySelectorAll(".navPage-subMenu-trigger");

        for (var mobileSubMenuTrigger of mobileSubMenuTriggers) {
            mobileSubMenuTrigger.addEventListener("click", function(e) {
                e.stopPropagation();

                var index = e.currentTarget.getAttribute("data-index");
                var subMenus = e.currentTarget.parentNode.parentNode.parentNode.querySelectorAll(".navPage-subMenu");
                subMenus[index].style.display = "block";
            });
        }
    }

    function configureSearchActionMobile() {
        var header = document.querySelector("header");
        var navPages = document.querySelector(".navPages-container");
        var burgerAction = document.querySelector(".mobileMenu-toggle");
        var searchAction = document.querySelector(".mobileMenu-search");
        var quickSearch = document.querySelector(".navPages-quickSearch");
        var quickSearchInput = document.querySelector(".navPages-quickSearch #search_query");

        // hide quicksearch on burger click
        burgerAction.addEventListener("click", function() {
            if (quickSearch.style.display === "block") {
                header.classList.remove("is-open");
                navPages.classList.remove("is-open");
                quickSearch.style.display = "none";
            }
        });

        // toggle quicksearch and focus on search input on search click
        searchAction.addEventListener("click", function() {
            if (quickSearch.style.display === "" || quickSearch.style.display === "none") {
                header.classList.add("is-open");
                navPages.classList.add("is-open");
                burgerAction.classList.remove("is-open");
                quickSearch.style.display = "block";

                // focus on search input
                setTimeout(function () {
                    quickSearchInput.focus();
                }, 100);
            } else {
                header.classList.remove("is-open");
                navPages.classList.remove("is-open");
                quickSearch.style.display = "none";
            }
        });
    }

    function configureSearchActionDesktop() {
        var quickSearchAction = document.querySelector(".navUser-action--quickSearch");
        var quickSearchInput = document.querySelector(".dropdown--quickSearch #search_query");

        // focus on search input on search click
        quickSearchAction.addEventListener("click", function() {
            setTimeout(function () {
                quickSearchInput.focus();
            }, 100);
        });

        document.addEventListener("click", function(e) {
            if (e.target && e.target.className == "quickSearchResults") {
                quickSearchAction.click();
            }
        });
    }

    function configureSizeGuideAction() {
        var sizeGuide = document.querySelector("#size-guide");

        if (sizeGuide) {
            var banglesNavItem = document.querySelector("#size-guide .modal-nav-item:first-child");
            var ringsNavItem = document.querySelector("#size-guide .modal-nav-item:nth-child(2)");
            var necklacesNavItem = document.querySelector("#size-guide .modal-nav-item:nth-child(3)");

            var banglesMainItem = document.querySelector("#size-guide .modal-main-item:first-child");
            var ringsMainItem = document.querySelector("#size-guide .modal-main-item:nth-child(2)");
            var necklacesMainItem = document.querySelector("#size-guide .modal-main-item:nth-child(3)");

            banglesNavItem.addEventListener("click", function() {
                banglesNavItem.style.color = "#000";
                ringsNavItem.style.color = "#999";
                necklacesNavItem.style.color = "#999";

                banglesMainItem.style.display = "block";
                ringsMainItem.style.display = "none";
                necklacesMainItem.style.display = "none";
            });

            ringsNavItem.addEventListener("click", function() {
                banglesNavItem.style.color = "#999";
                ringsNavItem.style.color = "#000";
                necklacesNavItem.style.color = "#999";

                banglesMainItem.style.display = "none";
                ringsMainItem.style.display = "block";
                necklacesMainItem.style.display = "none";
            });

            necklacesNavItem.addEventListener("click", function() {
                banglesNavItem.style.color = "#999";
                ringsNavItem.style.color = "#999";
                necklacesNavItem.style.color = "#000";

                banglesMainItem.style.display = "none";
                ringsMainItem.style.display = "none";
                necklacesMainItem.style.display = "block";
            });

            document.querySelector("#size-guide-hero-action").addEventListener("click", function(event) {
                event.preventDefault();

                hero("show");
            });
        }
    }
</script>
